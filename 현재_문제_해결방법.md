# ⚡ 현재 문제 해결 방법 (빠른 가이드)

## 🔴 현재 상황

스크린샷을 보니 **"Failed to fetch"** 에러가 발생하고 있습니다.

```
Failed to load resource: 401 (Unauthorized) /api/profile
Failed to load resource: 500 (Internal Server Error) /api/campaigns
TypeError: Failed to fetch
```

---

## ✅ 문제 원인

**Supabase 서버가 설정되지 않았습니다.**

현재 `.env.local`에 로컬 Supabase URL (`http://localhost:54321`)이 설정되어 있지만, **실제로 Supabase 서버가 실행되지 않아서** 연결할 수 없습니다.

---

## 🚀 즉시 해결 방법

### 방법 1: Supabase 클라우드 사용 (추천, 5분)

**가장 빠르고 쉬운 방법입니다.**

#### 1️⃣ Supabase 프로젝트 생성

```
1. https://app.supabase.com 접속
2. Sign Up (GitHub 계정 추천)
3. New Project 클릭
4. 프로젝트 정보 입력:
   - Name: blog-campaign
   - Password: 강력한 비밀번호 (저장!)
   - Region: Northeast Asia (Seoul)
   - Plan: Free
5. Create new project 클릭
6. 대기 (1-2분)
```

#### 2️⃣ API 키 복사

```
1. Settings (왼쪽 하단 톱니바퀴) → API
2. 다음 3개 복사:
   - Project URL
   - anon public
   - service_role
```

#### 3️⃣ 환경 변수 업데이트

**PowerShell에서 실행:**

```powershell
@"
# Supabase 클라우드
NEXT_PUBLIC_SUPABASE_URL=복사한_Project_URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=복사한_anon_public
SUPABASE_SERVICE_ROLE_KEY=복사한_service_role
"@ | Out-File -FilePath .env.local -Encoding UTF8 -Force
```

**예시:**
```env
NEXT_PUBLIC_SUPABASE_URL=https://abcdefghijk.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### 4️⃣ 데이터베이스 설정

```
1. Supabase 대시보드 → SQL Editor
2. 로컬 파일 열기: supabase/migrations/0002_create_blog_campaign_platform.sql
3. 내용 전체 복사
4. SQL Editor에 붙여넣기
5. Run 클릭
6. Success 확인
```

#### 5️⃣ 서버 재시작

```bash
# Ctrl+C로 서버 중지
npm run dev
```

#### 6️⃣ 브라우저 새로고침

```
Ctrl + Shift + R
```

---

### 방법 2: 로컬 Supabase 사용 (Docker 필요, 10분)

**Docker Desktop이 있다면 이 방법도 가능합니다.**

#### 1️⃣ Docker Desktop 확인

```bash
docker --version
```

없으면: https://www.docker.com/products/docker-desktop

#### 2️⃣ Supabase CLI 설치

```bash
npm install -g supabase
```

#### 3️⃣ Supabase 시작

```bash
supabase start
```

⏳ 첫 실행 시 5-10분 소요 (Docker 이미지 다운로드)

#### 4️⃣ 출력된 키 확인

```
API URL: http://localhost:54321
anon key: eyJhbGc...
service_role key: eyJhbGc...
```

#### 5️⃣ `.env.local` 업데이트

위에서 출력된 키를 `.env.local`에 복사

#### 6️⃣ 서버 재시작

```bash
npm run dev
```

---

## 🧪 테스트

### 1. 홈 페이지 확인

```
http://localhost:3000
```

- ✅ 페이지가 로드되어야 함
- ❌ "Failed to fetch" 에러 없어야 함

### 2. 회원가입 시도

```
http://localhost:3000/signup
```

1. 이메일: `test@example.com`
2. 비밀번호: `password123`
3. 회원가입 클릭

**성공:**
- ✅ 온보딩 페이지로 이동
- ✅ 이메일 자동 입력

**실패:**
- ❌ "Supabase 서버에 연결할 수 없습니다" → 환경 변수 재확인

### 3. 브라우저 콘솔 확인

```
F12 → Console 탭
```

- ❌ 401, 500 에러 없어야 함
- ✅ 정상 로드 메시지만

---

## 🆘 여전히 "Failed to fetch"가 나오면

### 체크리스트

1. **`.env.local` 파일 확인**
   ```bash
   # 파일이 프로젝트 루트에 있는지 확인
   dir .env.local
   ```

2. **환경 변수 형식 확인**
   ```env
   # 올바른 형식:
   NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
   
   # 잘못된 형식:
   NEXT_PUBLIC_SUPABASE_URL = "https://xxx.supabase.co"
   ```

3. **서버 완전히 재시작**
   ```bash
   # Ctrl+C로 완전히 중지
   # 그 다음:
   npm run dev
   ```

4. **브라우저 캐시 완전 삭제**
   ```
   Ctrl + Shift + Delete
   → 전체 기간 선택
   → 모든 항목 체크
   → 삭제
   → 브라우저 재시작
   ```

5. **Next.js 캐시 삭제**
   ```bash
   Remove-Item -Recurse -Force .next
   npm run dev
   ```

---

## 💡 추천 순서

**가장 빠른 해결 방법:**

1. ✅ **Supabase 클라우드 사용** (5분)
   - Docker 불필요
   - 무료
   - 바로 테스트 가능

2. ⏩ **서버 재시작** (필수!)
   ```bash
   Ctrl+C
   npm run dev
   ```

3. 🔄 **브라우저 강력 새로고침**
   ```
   Ctrl + Shift + R
   ```

4. 🧪 **회원가입 테스트**

---

## 📊 에러 메시지 해석

### "Failed to fetch"
→ Supabase 서버에 연결할 수 없음
→ **해결:** Supabase 설정 (위 방법 1 또는 2)

### "401 Unauthorized"
→ 인증 실패
→ **해결:** 환경 변수 확인, 서버 재시작

### "500 Internal Server Error"
→ 서버 내부 에러
→ **해결:** 데이터베이스 마이그레이션 확인

### "환경 변수를 확인하세요"
→ `.env.local` 파일 없거나 형식 오류
→ **해결:** 환경 변수 다시 설정

---

## 📚 상세 가이드

더 자세한 내용은 다음 파일을 참조하세요:

- **`SUPABASE_SETUP.md`** ⭐ - Supabase 설정 완벽 가이드
- **`LOGIN_ERROR_FIX.md`** - 로그인 에러 해결
- **`FIX_404_ERROR.md`** - 404 에러 해결
- **`QUICK_FIX.md`** - 빠른 수정 가이드

---

## ✅ 성공 체크리스트

다음을 순서대로 확인:

- [ ] Supabase 프로젝트 생성 (클라우드 또는 로컬)
- [ ] API 키 복사
- [ ] `.env.local` 업데이트
- [ ] 데이터베이스 마이그레이션
- [ ] 서버 재시작 (`npm run dev`)
- [ ] 브라우저 새로고침 (`Ctrl+Shift+R`)
- [ ] http://localhost:3000 접속
- [ ] "Failed to fetch" 에러 없음
- [ ] 회원가입 테스트 성공

**모두 완료하면 정상 작동합니다!** 🎉

---

## 💬 다음 단계

1. **Supabase 설정 완료**
2. **회원가입 테스트**
3. **온보딩 완료**
4. **체험단 기능 사용**

---

## 🆘 도움이 필요하면

다음 정보와 함께 질문하세요:

1. 어떤 방법 선택? (클라우드 or 로컬)
2. 어디까지 진행? (단계 번호)
3. 에러 메시지? (스크린샷 or 복사)
4. 브라우저 콘솔 로그? (F12)

빠르게 도와드리겠습니다! 😊

